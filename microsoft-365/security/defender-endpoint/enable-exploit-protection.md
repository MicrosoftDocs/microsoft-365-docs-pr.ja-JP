---
title: 攻撃に対する軽減に役立つエクスプロイト保護を有効にする
keywords: 悪用、軽減、攻撃、脆弱性
description: Windows 10 でエクスプロイト保護を有効にする方法について学習します。 エクスプロイト保護は、デバイスをマルウェアから保護するのに役立ちます。
search.product: eADQiWindows 10XVcnh
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
localization_priority: Normal
audience: ITPro
author: denisebmsft
ms.author: deniseb
ms.reviewer: ksarens
manager: dansimp
ms.technology: mde
ms.topic: how-to
ms.openlocfilehash: de91357d70eafef66b0f09b7ab92c645264ef4a0
ms.sourcegitcommit: dcb97fbfdae52960ae62b6faa707a05358193ed5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/25/2021
ms.locfileid: "51197913"
---
# <a name="enable-exploit-protection"></a>エクスプロイト保護を有効にする

[!INCLUDE [Microsoft 365 Defender rebranding](../../includes/microsoft-defender.md)]

**適用対象:**
- [Microsoft Defender for Endpoint](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)

>Defender for Endpoint を体験してみませんか? [無料試用版にサインアップします。](https://www.microsoft.com/microsoft-365/windows/microsoft-defender-atp?ocid=docs-wdatp-assignaccess-abovefoldlink)

[エクスプロイト保護](exploit-protection.md) は、悪用を使用してデバイスに感染し、拡散するマルウェアから保護するのに役立ちます。 エクスプロイト保護は、オペレーティング システムまたは個々のアプリに適用できるいくつかの軽減策で構成されます。

> [!IMPORTANT]
> .NET 2.0 は、一部のエクスプロイト保護機能 (特に、エクスポート アドレス フィルター (EAF) およびインポート アドレス フィルター (IAF) と互換性がありません。 .NET 2.0 を有効にしている場合、EAF と IAF の使用はサポートされていません。

エクスプロイト保護には、拡張軽減エクスペリエンス Toolkit (EMET) の多くの機能が含まれています。

次の方法を使用して、各軽減策を個別に有効にできます。   
- [Windows セキュリティ アプリ](#windows-security-app)
- [Microsoft Intune](#intune)
- [モバイル デバイス管理 (MDM)](#mdm)
- [Microsoft Endpoint Configuration Manager](#microsoft-endpoint-configuration-manager)
- [グループ ポリシー](#group-policy)
- [PowerShell](#powershell)

エクスプロイト保護は、Windows 10 で既定で構成されます。 各軽減策は、オン、オフ、または既定値に設定できます。 一部の軽減策には、追加のオプションがあります。

これらの設定 [を XML ファイルとしてエクスポートし、](import-export-exploit-protection-emet-xml.md) 他のデバイスに展開できます。

軽減策を監査モードに [設定することもできます](evaluate-exploit-protection.md)。 監査モードでは、デバイスの通常の使用に影響を与えることなく、軽減策の動作 (およびイベントの確認) をテストできます。

## <a name="windows-security-app"></a>Windows セキュリティ アプリ

1. タスク バーでシールド アイコンを選択するか、スタート メニューの [セキュリティ] を検索して、Windows セキュリティ アプリを開 **きます**。

2. [App **&コントロール] タイル** (または左側のメニュー バーのアプリ アイコン) を選択し、[エクスプロイト保護の設定] **を選択します**。

3. [プログラムの **設定] に** 移動し、軽減策を適用するアプリを選択します。 <br/>
    - 構成するアプリが既に一覧に表示されている場合は、アプリを選択し、[編集] を **選択します**。
    - アプリが一覧に表示されない場合は、一覧の上部にある [プログラムの追加] を選択 **して** カスタマイズし、アプリの追加方法を選択します。 <br/>
    - [ **プログラム名で追加] を** 使用して、その名前を持つ実行中のプロセスに軽減策を適用します。 拡張子を持つファイルを指定する必要があります。 完全なパスを入力すると、その場所に名前が付くアプリにのみ軽減策を制限できます。
    - 標準の Windows Explorer **ファイル ピッカー** ウィンドウを使用して、目的のファイルを検索して選択するには、[厳密なファイル パスを選択する] を使用します。

4. アプリを選択すると、適用できるすべての軽減策の一覧が表示されます。 [監査] **を選択** すると、監査モードでのみ軽減策が適用されます。 プロセスまたはアプリを再起動する必要がある場合、または Windows を再起動する必要がある場合に通知されます。

5. 構成するアプリと軽減策について、手順 3 ~ 4 を繰り返します。

6. [システム **設定] セクション** で、構成する軽減策を見つけて、次のいずれかの設定を指定します。 [プログラムの設定] セクションで個別に構成されていない **アプリは、** ここで構成されている設定を使用します。<br/>
    - **既定でオン**: この軽減策がアプリ固有の [プログラムの設定] セクションで設定されているアプリに対して **有効** になっています。
    - **既定ではオフ**: この軽減策がアプリ固有の [プログラムの設定] セクションで設定されているアプリでは、軽減策 **は無効** になっています。
    - **既定値を** 使用する: 軽減策は、Windows 10 インストールによって設定される既定の構成に応じて有効または無効になります。既定値 (**On** または **Off**) は、軽減策ごとに既定のラベルを使用するの **横に常** に指定されます。

7. 構成するシステム レベルの軽減策すべてについて、手順 6 を繰り返します。 構成 **の設定** が完了したら、[適用] を選択します。

[プログラムの設定] セクションにアプリを追加し、そこで個別の軽減設定を構成する場合は、[システム設定] セクションで指定したのと同じ軽減策の構成の上に **適用されます。** 次のマトリックスと例は、既定値の動作を説明するのに役立ちます。

|[プログラムの **設定] で有効** | システム設定 **で有効** | 動作 |
|:---|:---|:---|
|![チェック マークはい](/security/defender-endpoint/images/svg/check-yes) | ![チェック マークなし](/security/defender-endpoint/images/svg/check-no) | [プログラムの設定 **] で定義されている** |
|![チェック マークはい](/security/defender-endpoint/images/svg/check-yes) | ![チェック マークはい](/security/defender-endpoint/images/svg/check-yes) | [プログラムの設定 **] で定義されている** |
|![チェック マークなし](/security/defender-endpoint/images/svg/check-no) | ![チェック マークはい](/security/defender-endpoint/images/svg/check-yes) | [システム設定] **で定義されている** |
|![チェック マークなし](/security/defender-endpoint/images/svg/check-no) | ![チェック マークはい](/security/defender-endpoint/images/svg/check-yes) | [既定のオプションを使用 **する] で定義されている既定値** |

### <a name="example-1-mikael-configures-data-execution-prevention-in-system-settings-section-to-be-off-by-default"></a>例 1: ミカエルがシステム設定セクションのデータ実行防止を既定でオフに構成する

ミカエルは、 *アプリの* test.exe[プログラムの設定 **] セクションに追加** します。 そのアプリのオプションで、[データ実行防止 **(DEP)]** の下で、システム設定の上書きオプションを有効にし、スイッチを [オン] に **設定します**。 [プログラムの設定] セクションに他の **アプリは表示** されません。

その結果、DEP が有効になっているのは、次 *のtest.exe。* 他のすべてのアプリには DEP が適用されません。

### <a name="example-2-josie-configures-data-execution-prevention-in-system-settings-to-be-off-by-default"></a>例 2: Josie がシステム設定のデータ実行防止を既定でオフに構成する

Josie は、[プログラムの *test.exe]* セクションにアプリ **の設定を追加** します。 そのアプリのオプションの [データ実行防止 **(DEP)]** で、Josie は [システム設定の上書き] オプションを有効にし、スイッチを [オン] に **設定します**。 

Josie は、アプリmiles.exeを [プログラムの設定] セクションに追加し、コントロール フロー ガード **(CFG)** を On に構成 **します**。 Josie は、DEP の **[** システム設定の上書き] オプションを有効にしたり、そのアプリのその他の軽減策を有効にしたりは行わない。

その結果、DEP が有効になっているので、test.exe。 DEP は、他のアプリ (このアプリを含む)*に対miles.exe。* CFG は、ユーザーに対 *してmiles.exe。*

1. タスク バーでシールド アイコンを選択するか、Defender のスタート メニューを検索して、Windows セキュリティ アプリを開 **きます**。

2. [App **& コントロール** ] タイル (または左側のメニュー バーのアプリ アイコン) を選択し、[エクスプロイト保護] **を選択します**。

3. [プログラムの **設定] に** 移動し、軽減策を適用するアプリを選択します。<br/>
    - 構成するアプリが既に一覧に表示されている場合は、アプリを選択し、[編集] を **選択します**。
    - アプリが一覧に表示されない場合は、一覧の上部にある [プログラムの追加] を選択 **して** カスタマイズし、アプリの追加方法を選択します。<br/>
     - [ **プログラム名で追加] を** 使用して、その名前を持つ実行中のプロセスに軽減策を適用します。 拡張子を持つファイルを指定する必要があります。 完全なパスを入力すると、その場所に名前が付くアプリにのみ軽減策を制限できます。
     - 標準の Windows Explorer **ファイル ピッカー** ウィンドウを使用して、目的のファイルを検索して選択するには、[厳密なファイル パスを選択する] を使用します。

4. アプリを選択すると、適用できるすべての軽減策の一覧が表示されます。 [監査] **を選択** すると、監査モードでのみ軽減策が適用されます。 プロセスまたはアプリを再起動する必要がある場合、または Windows を再起動する必要がある場合に通知されます。

5. 構成するアプリと軽減策について、手順 3 ~ 4 を繰り返します。 構成 **の設定** が完了したら、[適用] を選択します。

## <a name="intune"></a>Intune

1. Azure ポータルにサインイン [し、Intune](https://portal.azure.com) を開きます。

2. [デバイス構成 **プロファイル]**  >  **[プロファイルの**  >  **作成] に移動します**。

3. プロファイルに名前を付け **、[Windows 10** 以降] と [エンドポイント保護] **を選択します**。

   ![エンドポイント保護プロファイルの作成](/microsoft-365/security/defender-endpoint/images/create-endpoint-protection-profile)<br/>

4. [Exploit **Guard エクスプ**  >  **ロイトWindows Defenderの構成**  >  **] を選択します**。

5. エクスプロイ [ト保護設定を使用](https://docs.microsoft.com/windows/client-management/mdm/policy-csp-exploitguard) して XML ファイルをアップロードします。

   ![Intune でネットワーク保護を有効にする](/microsoft-365/security/defender-endpoint/images/enable-ep-intune)<br/>

6. **[OK] を** 選択して開いている各ブレードを保存し、[作成] を **選択します**。

7. [プロファイルの割 **り当て] タブを** 選択し、[すべてのデバイス] の [すべてのユーザー] &ポリシーを割 **り当** て、[保存] を **選択します**。

## <a name="mdm"></a>MDM

[./Vendor/MSFT/Policy/Config/ExploitGuard/ExploitProtectionSettings](https://docs.microsoft.com/windows/client-management/mdm/policy-csp-exploitguard)構成サービス プロバイダー (CSP) を使用して、エクスプロイト保護の軽減策を有効または無効にするか、監査モードを使用します。

## <a name="microsoft-endpoint-manager"></a>Microsoft Endpoint Manager

1. Microsoft Endpoint Manager で、[エンドポイント セキュリティ攻撃]**サーフェス**  >  **の縮小に移動します**。 

2. [ポリシー **プラットフォームの作成**  >  **] を** 選択し、[プロファイル] で [**エクスプ** ロイト保護]**を選択します**。 その後、**[作成]** を選択します。

3. 名前と説明を指定し、[次へ] を **選択します**。

4. [XML **ファイルの選択]** を選択し、エクスプロイト保護 XML ファイルの場所を参照します。 ファイルを選択し、[次へ] を **選択します**。

5. 必要に **応じて、** スコープ タグ **と割り当てを** 構成します。 

6. [ **レビューと作成] で** 構成を確認し、[作成] を **選択します**。


## <a name="microsoft-endpoint-configuration-manager"></a>Microsoft Endpoint Configuration Manager

1. Microsoft Endpoint Configuration Manager で、[アセットとコンプライアンス エンドポイント保護] に移動 **し**、[Exploit  >    >  **Guard Windows Defenderに移動します**。

2. [ホーム **エクスプ**  >  **ロイト ガード ポリシーの作成] を選択します**。

3. 名前と説明を指定し、[エクスプロイト保護] **を** 選択し、[次へ] を **選択します**。

4. エクスプロイト保護 XML ファイルの場所を参照し、[次へ] を **選択します**。

5. 設定を確認し、[次へ] **を選択して** ポリシーを作成します。

6. ポリシーを作成したら、[閉じる] を **選択します**。

## <a name="group-policy"></a>グループ ポリシー

1. グループ ポリシー管理デバイスで、グループ ポリシー [管理](https://technet.microsoft.com/library/cc731212.aspx)コンソールを開き、構成するグループ ポリシー オブジェクトを右クリックし、[編集] をクリック **します**。

2. グループ ポリシー **管理エディターで、[コンピューター** の構成] に **移動し、[** 管理用 **テンプレート] を選択します**。

3. ツリーを Windows コンポーネント **に展開** Windows Defender Exploit Guard Exploit Protection の一般的な一連のエクスプロイト保護  >    >    >  **設定を使用します**。

4. [ **有効] を** 選択し、XML ファイルの場所 [を入力し、[OK]](https://docs.microsoft.com/windows/client-management/mdm/policy-csp-exploitguard)を **選択します**。

## <a name="powershell"></a>PowerShell

PowerShell 動詞またはコマンドレット `Get` `Set` を使用できます `ProcessMitigation` 。 Using は、デバイスで有効になっている軽減策の現在の構成状態を一覧表示します。コマンドレットとアプリの exe を追加して、そのアプリの軽減策 `Get` `-Name` を確認します。

```PowerShell
Get-ProcessMitigation -Name processName.exe
```

> [!IMPORTANT]
> 構成されていないシステム レベルの軽減策では、の状態が表示されます `NOTSET` 。
> - システム レベルの設定では `NOTSET` 、その軽減策の既定の設定が適用されているを示します。
> - アプリ レベルの設定では、 `NOTSET` 軽減策のシステム レベルの設定が適用されます。
> 各システム レベルの軽減策の既定の設定は、Windows セキュリティで確認できます。

各 `Set` 軽減策を次の形式で構成する場合に使用します。

```PowerShell
Set-ProcessMitigation -<scope> <app executable> -<action> <mitigation or options>,<mitigation or options>,<mitigation or options>
```

ここで、

* \<Scope>:
  * `-Name` を使用して、軽減策を特定のアプリに適用する必要があります。 このフラグの後にアプリの実行可能ファイルを指定します。
    * `-System` 軽減策をシステム レベルで適用する必要があります。
* \<Action>:
  * `-Enable` を使用して軽減策を有効にする
  * `-Disable` 軽減策を無効にするには
* \<Mitigation>:
  * 軽減策のコマンドレットと、任意のサブオプション (スペースで囲まれた) を指定します。 各軽減策はコンマで区切られます。

たとえば、ATL サンク エミュレーションを使用してデータ実行防止 (DEP) 軽減策を有効にし、フォルダー *C:\Apps\LOB\tests* の *testing.exe* という実行可能ファイルに対して有効にし、その実行可能ファイルが子プロセスを作成しなからせた場合は、次のコマンドを使用します。

```PowerShell
Set-ProcessMitigation -Name c:\apps\lob\tests\testing.exe -Enable DEP, EmulateAtlThunks, DisallowChildProcessCreation
```

> [!IMPORTANT]
> 各軽減オプションをコンマで区切ります。

システム レベルで DEP を適用する場合は、次のコマンドを使用します。

```PowerShell
Set-Processmitigation -System -Enable DEP
```

軽減策を無効にするには、 に置き換 `-Enable` える `-Disable` 必要があります。 ただし、アプリ レベルの軽減策では、そのアプリに対してだけ軽減策を強制的に無効にします。

軽減策をシステムの既定に戻す必要がある場合は、次の例に示すコマンドレットも含 `-Remove` める必要があります。

```PowerShell
Set-Processmitigation -Name test.exe -Remove -Disable DEP
```

次の表に、**またはコマンドレット** パラメーターと一緒に使用する個々の軽減策 (および使用可能な場合の監査) `-Enable` `-Disable` の一覧を示します。

| 軽減の種類 | 適用対象 | 軽減コマンドレットパラメーター キーワード | 監査モードのコマンドレット パラメーター |
| :-------------- | :--------- | :---------------------------------- | :-------------------------- |
| 制御フロー ガード (CFG) | システムとアプリ レベル |   `CFG`,   `StrictCFG`,   `SuppressExports`  | 監査が利用できない |
| データ実行防止 (DEP) | システムとアプリ レベル |   `DEP`,   `EmulateAtlThunks`  | 監査が利用できない |
| イメージのランダム化を強制する (必須 ASLR) | システムとアプリ レベル |   `ForceRelocateImages`  | 監査が利用できない |
| メモリ割り当てをランダム化する (ボトムアップ ASLR) | システムとアプリ レベル |   `BottomUp`,   `HighEntropy`  | 監査が利用できない
| 例外チェーンの検証 (SEHOP) | システムとアプリ レベル |   `SEHOP`,   `SEHOPTelemetry`  | 監査が利用できない |
| ヒープ整合性の検証 | システムとアプリ レベル |   `TerminateOnError`  | 監査が利用できない |
| 任意のコード ガード (ACG) | アプリ レベルのみ |   `DynamicCode`  |   `AuditDynamicCode` |
| 低整合性イメージをブロックする | アプリ レベルのみ |   `BlockLowLabel`  |   `AuditImageLoad` |
| リモート イメージをブロックする | アプリ レベルのみ |   `BlockRemoteImages`  | 監査が利用できない |
| 信頼されていないフォントをブロックする | アプリ レベルのみ |   `DisableNonSystemFonts`  |   `AuditFont`,   `FontAuditOnly` |
| コード整合性ガード | アプリ レベルのみ |   `BlockNonMicrosoftSigned`,   `AllowStoreSigned`  |   AuditMicrosoftSigned、AuditStoreSigned |
| 拡張ポイントを無効にする | アプリ レベルのみ |   `ExtensionPoint`  | 監査が利用できない |
| Win32k システム呼び出しを無効にする | アプリ レベルのみ |   `DisableWin32kSystemCalls`  |   `AuditSystemCall` |
| 子プロセスを許可しない | アプリ レベルのみ |   `DisallowChildProcessCreation`  |   `AuditChildProcess` |
| アドレス フィルターのエクスポート (EAF) | アプリ レベルのみ |   `EnableExportAddressFilterPlus``EnableExportAddressFilter` <a href="#r1" id="t1"> \[ 、1 \] </a>   | 監査は使用<a href="#r2" id="t2"> \[ できません \] 2</a> |
| アドレス フィルターのインポート (IAF) | アプリ レベルのみ |   `EnableImportAddressFilter`  | 監査は使用<a href="#r2" id="t2"> \[ できません \] 2</a> |
| 実行のシミュレーション (SimExec) | アプリ レベルのみ |   `EnableRopSimExec`  | 監査は使用<a href="#r2" id="t2"> \[ できません \] 2</a> |
| API 呼び出しの検証 (CallerCheck) | アプリ レベルのみ |   `EnableRopCallerCheck`  | 監査は使用<a href="#r2" id="t2"> \[ できません \] 2</a> |
| ハンドルの使用状況を検証する | アプリ レベルのみ |   `StrictHandle`  | 監査が利用できない |
| イメージの依存関係の整合性を検証する | アプリ レベルのみ |   `EnforceModuleDepencySigning`  | 監査が利用できない |
| スタック整合性の検証 (StackPivot) | アプリ レベルのみ |   `EnableRopStackPivot`  | 監査は使用<a href="#r2" id="t2"> \[ できません \] 2</a> |

<a href="#t1" id="r1"> \[ 1 \] </a>: プロセスの DLL の EAF モジュールを有効にするには、次の形式を使用します。

```PowerShell
Set-ProcessMitigation -Name processName.exe -Enable EnableExportAddressFilterPlus -EAFModules dllName1.dll,dllName2.dll
```
<a href="#t2" id="r2"> \[ 2 \] </a>: この軽減策の監査は、PowerShell コマンドレットでは使用できません。

## <a name="customize-the-notification"></a>通知をカスタマイズする

ルールが [トリガーされ](https://docs.microsoft.com/windows/security/threat-protection/windows-defender-security-center/windows-defender-security-center) 、アプリまたはファイルがブロックされる場合の通知のカスタマイズの詳細については、「Windows セキュリティ」の記事を参照してください。

## <a name="see-also"></a>関連項目

- [エクスプロイト保護の評価](evaluate-exploit-protection.md)
- [エクスプロイト保護の軽減策の構成と監査](customize-exploit-protection.md)
- [エクスプロイト保護構成のインポート、エクスポート、および展開](import-export-exploit-protection-emet-xml.md)
